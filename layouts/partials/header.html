<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="{{ "" | absLangURL }}" accesskey="h" title="{{ .Site.Title }} (Alt + H)">
                {{ .Site.Title }}
            </a>
            
            {{- if (not site.Params.disableThemeToggle) }}
            <button id="theme-toggle" accesskey="t" title="Alternar Tema (Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            {{- end }}
        </div>
        <ul id="menu" class="menu">
            <li>
                <a href="/posts/" class="menu-item">Posts</a>
            </li>
            <li>
                <a href="/categories/" class="menu-item">Categorias</a>
            </li>
            <li>
                <a href="#" id="btn-newsletter" class="menu-item">Newsletter</a>
            </li>
            <li>
                <a href="/search/" class="menu-item">Pesquisar</a>
            </li>
        </ul>
    </nav>
</header>

<!-- Modal Newsletter -->
<div id="newsletter-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        {{ partial "subscribe.html" . }}
    </div>
</div>

<style>
/* Estilo minimalista para o menu e botões similar à imagem de referência */
.nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border-bottom: none;
}

.logo {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.logo a {
    font-size: 24px;
    font-weight: bold;
    color: var(--primary);
    text-decoration: none;
}

/* Estilos para o botão de tema */
#theme-toggle {
    border: 0;
    background: none;
    cursor: pointer;
    padding: 0;
    color: var(--primary);
    height: 24px;
    opacity: 0.8;
    display: flex;
    align-items: center;
    margin-top: 2px; /* Ajuste fino para alinhar com o texto */
}

#theme-toggle svg {
    display: block;
    width: 20px;
    height: 20px;
}

#theme-toggle:hover {
    opacity: 1;
}

html.dark #moon {
    display: none;
}

html:not(.dark) #sun {
    display: none;
}

.menu {
    display: flex;
    align-items: center;
    gap: 1.2rem;
    list-style: none;
    margin: 0;
    padding: 0;
}

.menu-item {
    text-decoration: none;
    font-size: 0.9rem;
    color: var(--primary);
    transition: color 0.2s;
    padding: 0;
    border-bottom: none;
}

.menu-item:hover {
    color: var(--primary);
    opacity: 0.8;
    border-bottom: none;
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background: var(--theme);
    padding: 2rem;
    border-radius: 8px;
    position: relative;
    width: 90%;
    max-width: 500px;
    margin: 2rem auto;
}

.close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--primary);
}

/* Responsividade */
@media screen and (max-width: 768px) {
    .nav {
        flex-direction: row;
        padding: 1rem;
    }

    .menu {
        justify-content: flex-end;
        gap: 1.5rem;
    }

    .menu-item {
        padding: 0;
        font-size: 0.8rem;
    }

    .modal-content {
        width: 95%;
        margin: 1rem;
        padding: 1.5rem;
    }
}

/* Animação do modal */
.modal.show {
    display: flex;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
</style>

<script>
const modal = document.getElementById('newsletter-modal');
const btn = document.getElementById('btn-newsletter');
const closeBtn = document.querySelector('.close');

btn.addEventListener('click', function(e) {
    e.preventDefault();
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
});

closeBtn.addEventListener('click', function() {
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
});

window.addEventListener('click', function(e) {
    if (e.target === modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
});

document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && modal.style.display === 'flex') {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
});

// Script para o botão de alternar tema
const themeToggle = document.getElementById("theme-toggle");
const htmlElement = document.documentElement;

// Função para definir o tema
function setTheme(theme) {
    if (theme === 'dark') {
        htmlElement.classList.add('dark');
        localStorage.setItem("pref-theme", 'dark');
    } else {
        htmlElement.classList.remove('dark');
        localStorage.setItem("pref-theme", 'light');
    }
}

// Evento de clique no botão
themeToggle?.addEventListener("click", () => {
    const isDark = htmlElement.classList.contains('dark');
    setTheme(isDark ? 'light' : 'dark');
});

// Verifica o tema preferido ao carregar a página
(() => {
    const savedTheme = localStorage.getItem("pref-theme");
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    if (savedTheme) {
        setTheme(savedTheme);
    } else {
        setTheme(prefersDark ? 'dark' : 'light');
    }
    
    // Torna o botão visível após definir o tema inicial
    if (themeToggle) {
        themeToggle.style.display = 'inline-block';
    }
})();

// Atualiza o tema quando a preferência do sistema mudar
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
    const savedTheme = localStorage.getItem("pref-theme");
    if (!savedTheme) {
        setTheme(e.matches ? 'dark' : 'light');
    }
});
</script>
